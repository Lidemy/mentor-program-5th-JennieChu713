## 跟你朋友介紹 Git

## Git 是什麼

直白地說，就是可以**進行版本控制的程式**。其實管理概念上跟過往**以不同資料夾管理版本**的方式差不多——建立了第一份的資料夾之後，再新建立的資料夾就等同一個新的版本，而且每份資料夾都會以不重複亂數的名稱命名，這也就能避免版本的衝突；如果是不會更新或者沒需要作版本控制的部分時，就獨自成一個資料夾即可；而想要呈現是最新的版本時，就先以檔案格式的形式存在便行，直到又有更新的版本，再改放入自己版本的資料夾中就好。

概念總結：

- 建立一個新版本 = 開一個新的資料夾，且以不重複亂數命名來避免版本衝突。如果想知道整個先後，可以查看資料夾建立的時間。
- 最新的版本 = 檔案形式的存在。
- 不作版本控制的檔案和資料夾 = 獨自成一個資料夾。

用圖片表示的話，整體看起來就像這樣：

![資料夾區別](./img/file_sep.png)

那麼這裡再置換成 Git 的話：

![ Git 區別](./img/git_sep.png)

看起來差不多，對不對？儘管不同於資料夾的保存方式，不過 Git 的版本控制大體就是這樣的概念。


## 安裝 Git

如果是用**Windows**系統，但**已經安裝 [Git-Bash](https://gitforwindows.org/)**，裡面就**已經具備 Git **的部分了，可以不用再另外安裝。

如果你是用 **Mac**，然後**版本是10.9以上**（你可以點選左上角落的蘋果圖案從「關於這台Mac...」來確認），你可以打開CLI 中直接輸入`git --version`，如果電腦上沒有安裝，這裡會<u>自動引導你安裝 Git</u>。

如果都不符合上述情況，請安裝 [Git](https://www.notion.so/Week1-a6369a11f8044667be333679705b651e#0a80e88fd96b4da5b23eb1f9f442b6b7)。這裡就如平常你安裝軟體的方式一樣，照著步驟安裝即可。

## 如何用 Git 進行版本控制

##### 一行流程：

`cd 想要進行版本控制的資料夾` → `git init` → `touch .gitignore` → `git add .` → `git commit -m '說明描述'`

##### 步驟解說： 

0. 打開命令列介面，**一定要先到你想用 Git 來進行版本控制的資料夾中**。

1. **`git init`**

   <u>專案初始化</u>，也就表示<u>開始使用 Git 進行版本控制</u>，也是非常重要的第一步。如果沒有執行這個步驟的話，接下來什麼都不會開始！

2. **`touch .gitignore`**

   這是 Git 中特別的檔案，你把它想成是一個告訴 Git 無視哪些東西的忽略名單，只要把不想要 Git 追蹤的檔案跟資料夾的名稱寫進檔案中即可。

3. **`git add 檔案名稱`**

   當你檔案處理到一個段落後，就可以用這個指令把檔案放進 Git 的版本控制中。如果你想將<u>所有東西一次加入 Git 的版本控制</u>裡，就可以寫成**`git add .`**。

4. **`git commit -m "說明"`**

   這就是建立一個版本，簡單地說就是<u>在一條時間軸上的建立存取點</u>（可以想成是在一條路上設置路標），如果日後有什麼需要的話，你就可以回到這個時間點進行修改。 `-m "說明"`就是寫一些簡單的說明描述，也方便你回頭看的時候知道這個大概是做了什麼。如果是**已經加入 Git 版本控制中**的檔案，可以直接寫成 `git commit -am "說明"`，來省略 add 的步驟。記住是**只限已經加入 Git 的東西**而已！很重要所以加粗兩次！如果是途中新增的檔案，一定還是要經過 `git add` 才可以。

此外，你也能藉著以下這些指令，確認整個版本控制的狀況：

- **`git log`**

  這裡可以看到過去每個建立版本的資訊，包括**版本的 ID**（亂數一樣的字串）。要跳出瀏覽的話，按 q 即可以離開。如果你覺得資訊太煩雜的話，可以在後面加上 `--oneline`，它就會顯示比較簡短的訊息。

- **`git status`**

  這可以知道有哪些檔案和資料夾沒有被加入 Git 的版本控制中，或者有沒有變更。沒有被加入 Git 的東西前面會顯示為" Untracked "，如果是有變動的則為 " Modified "。

以上就是 Git 基本的操作流程。之後不外乎就是 `add` 跟 `commit`的輪迴。

如果想要保留一個原來的版本又同時有一個複本可以進行修改時，可以藉著**建立分支**（branch）來達成。

1. **`git branch 分支名稱`**

   建立分支。如果要查看有哪些分支，可使用`git branch -v`。如果要刪除，則是`git branch -d 分支名稱`。更改現在在用的分支名稱可用`git branch -m 新分支名稱`。

2. **`git checkout 分支名稱`**

   可以切換到該分支。這個指令同時也可以**讓你切換到某個版本建立的時間點**，寫成`git checkout 版本ID`。若是應用在檔案的話，則可以使<u>該檔案恢復到更動前的狀態</u>（尚未 `commit` 的情況下），`git checkout -- 檔案名稱`。

3. **`git merge 分支名稱`**

   如果最後決定要用新改好的版本時，便可以將該分支合併回初始分支上，也就是合併到 master 或 main 分支上。

其他對應的狀況：

- **`git commit --amend`**

  修正剛剛 commit 的說明內容。

- **`git reset HEAD^`**

  回到上一個版本建立的時間點。`HEAD^`代表是回到當前所在的上一個版本建立的時間點。這個部分又可以用<u>版本 ID</u> 置換，表示**回到該版本建立的時間點**。後面可以選擇使用`--soft`、`--hard`或`--mixed`。這是表示期望**該版本中檔案跟資料夾恢復的狀態**。`--soft`僅移除 commit，內容不會有變動；`--hard`是完全移除了 commit及內容——你可以想成是<u>指定的版本像卡牌中的一張卡被抽掉一樣</u>，因此只能看到在它之前，也就是上一個版本的狀態。`--mixed`則是預設值，除了移除 commit 以及從版本控制名單踢掉新增的東西外，已經加入的檔案跟資料夾的內容則不變。

- **`git diff 檔案名稱`**

  可以看到該檔案有哪些變動跟差異。

## 進階應用 Git：與 GitHub 的推拉同步術

### GitHub是什麼？

GitHub其實就是一個可以放置 repository、Git-based 的視覺化平台。通俗地說，它是一個<u>你可以放置作品並分享、甚至能讓別人一起參與作品改良的線上倉庫</u>。

### 使用 GitHub

首先，請先去 [GitHub](https://github.com) 申請帳號。如果已經有的話請直接登入吧！

1. 登入完進入頁面後，請點選**右上方「+」的圖案**（在你的帳號頭像隔壁），然後按**「new repository」**來新增一個 repository。把最必要的 repository 名稱填完送出，就會直接來到新增的 repository 的頁面了！

2. 在 repository 的頁面中，有幾個貼心提示說明要怎麼把你的作品「推」到 GitHub 上。請參考<u>最下面的針對已經新增 repository 的說明區塊</u>。只要依照當中的順序，把指令一一執行在你電腦的CLI中（記得要先`cd`到你想要推的作品資料夾中），就可以把作品推到 GitHub 上了！ 這裡我們就來簡單說明每一行指令代表的意義：

  3. **`git remote add origin 你的repository網址`**

     先指定遠端是哪個 repository（即那條網址），並以 origin 作為 repository 的代稱。

  4. **`git branch -M main`**

     將本地的初始分支從 master 重新命名為 main。雖然過往都是預設為 master，不過近期被判斷是帶有歧視性的字詞，因此在 [2020 年 10 月](https://www.ithome.com.tw/news/140094)之後一率改成 main 。其實就單純只是換了名字而已，本質沒有改變。

  5. **`git push -u origin main`**

     **在你完成 commit 之後**，最後將本地的分支 main 推到 GitHub 的指定 repository 上。 `-u`就是設定要把東西推到哪裡的意思。這一部分以後是可以省略不寫。

  6. **`git pull origin main`**

     這是當你在 GitHub 上進行更動之後，你可以從藉著 CLI 把上面更新的部分「拉」到自己的電腦中，也就把你自己電腦裡的作品也做了一樣的更新。用比較術語的方式來說，就是把 GitHub 的改變用<u>人工的方式</u>**同步**到你的電腦中。反過來說，你也可以把你電腦中所做的更動同步到 GitHub 上，也就是執行 `push`指令的部分。

  你只要記得，**推Hub**，**拉Git**，就表示哪邊被同步。

---

### 快速導覽表

| 步驟或關聯 |                  指令                  |         常搭配使用的選擇性指令          |                             說明                             |
| :--------: | :------------------------------------: | :-------------------------------------: | :----------------------------------------------------------: |
|     1      |               `git init`               |                                         |             啟動 Git 版本控制，版本控制初始化。              |
|     2      |           `touch .gitignore`           |                                         | 用來免除版本控制的忽略名單。將檔案名稱或資料夾名稱寫入檔案中即可。 |
|     3      |       `git add 檔案或資料夾名稱`       |                   `.`                   | 將異動或新增的檔案和資料夾加入版本控制中。`.`可以一次加入所有的檔案和資料夾。 |
|     4      |         `git commit -m "說明"`         |            `-am`、`--amend`             | 建立版本，亦是一個可以回溯的時間點。`-m`是用來簡短說明該版本的變動。`-m`可以替換成`-am`，表示一併完成 add 的步驟並 commit。**`-am` 只限於已經加入過的檔案和資料夾**。 `--amend`則是可以修改最後 commit 的說明。 |
|     -      |               `git log`                |               `--oneline`               | 查看版本建立的紀錄以及每個版本的 ID 。`--oneline`則顯示較精簡的資訊。 |
|     -      |              `git status`              |                                         | 查看檔案和資料夾的版本控制狀態。尚未加入版本控制的狀態為 " Untracked "，已經加入但有變動的狀態是 " Modified "。**不會顯示被加入.gitignore的東西**。 |
|     -      |          `git diff 檔案名稱`           |                                         |               可以查看該檔案的內容有哪先變動。               |
|     -      |         `git branch 分支名稱`          |  `-v`、`-d 分支名稱`、`-m 新分支名稱`   | 建立分支。`-v`可以查看有哪些分支，`-d`是刪除所選的分支，`-m`則是重新命名該分支。 |
|     -      |        `git checkout 分支名稱`         |         `版本ID`、`-- 檔案名稱`         | 切換到所選的分支。如果換成版本 ID，則可以回到該版本建立時的狀態查看。若使用`-- 檔案名稱`，則會恢復該檔案上一次儲存前的狀態。**僅限尚未 commit 之前**。 |
|     -      |          `git merge 分支名稱`          |                                         |        將分支合併於初始分支，也就是 master 或 main 。        |
|     -      |           `git reset HEAD^`            | `版本ID`；`--soft`、`--hard`、`--mixed` | 重置到某個版本時的狀態。`HEAD^`表示是回到當前所在（HEAD）的前一個版本建立的時間點，這邊也可以換成版本的 ID。`--soft`、`--hard`、`--mixed`則是針對該版本中檔案與資料夾的恢復狀態。`--soft`僅移除 commit 而當前內容及新增資料不變，`--hard`是完全移除 commit 以及當前內容；最後`--mixed`則是移除 commit 、保留已經更動的內容，但未加入新增的資料，亦是未指定時的預設值。 |
|   GitHub   | `git remote add origin 你的repository網址` |                                         |     設定遠端要同步的 repository，並設置 origin 為代號。      |
|   GitHub   |          `git branch -M main`          |                                         |              重新命名本地端的初始分支為 main。               |
|   GitHub   |   `git push -u origin 本地分支名稱`    |                                         | 將本地端的分支同步推到 GitHub 以 origin 為代表的 repository 上。 `-u`為指定推到哪個地方，以後可以省略不寫。 |
|   GitHub   |         `git pull origin main`         |                                         |        把遠端 GitHub 的資料同步拉到本地端初始分支上。        |